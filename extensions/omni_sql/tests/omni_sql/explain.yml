$schema: "https://raw.githubusercontent.com/omnigres/omnigres/master/pg_yregress/schema.json"
instance:
  init:
  - create extension omni_sql cascade

tests:

- name: explain select
  query: select omni_sql.explain('select 1')
  results:
  - explain: [{"Plan":{"Node Type":"Result","Parallel Aware":false,"Startup Cost":0.00,"Total Cost":0.01,"Plan Rows":1,"Plan Width":4}}]

- name: explain insert
  query: select omni_sql.explain('insert into test_table values (1)')
  results:
  - explain: [{"Plan":{"Node Type":"Insert","Parallel Aware":false,"Startup Cost":0.00,"Total Cost":0.01,"Plan Rows":1,"Plan Width":4}}]

- name: explain update
  query: select omni_sql.explain('update test_table set value = 2 where value = 1')
  results:
  - explain: [{"Plan":{"Node Type":"Update","Parallel Aware":false,"Startup Cost":0.00,"Total Cost":0.01,"Plan Rows":1,"Plan Width":4}}]

- name: explain delete
  query: select omni_sql.explain('delete from test_table where value = 1')
  results:
  - explain: [{"Plan":{"Node Type":"Delete","Parallel Aware":false,"Startup Cost":0.00,"Total Cost":0.01,"Plan Rows":1,"Plan Width":4}}]
