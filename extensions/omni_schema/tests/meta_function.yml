$schema: "https://raw.githubusercontent.com/omnigres/omnigres/master/pg_yregress/schema.json"
instance:
  init:
    - create extension omni_schema cascade
    - create schema test;
tests:

- name: created function shows up with expected values
  steps:
    - create function test.test_function(input text) returns text as $$select input || ' ' || version() $$ language sql
    - query: select id,
                    schema_id,
                    schema_name,
                    name,
                    type_sig,
                    parameters,
                    definition,
                    description,
                    type,
                    return_type,
                    language,
                    returns_set,
                    parallel,
                    volatility,
                    access_privileges,
                    security
            from omni_schema.function where id = omni_schema.function_id('test', 'test_function', '{text}');
      results:
      - id: "(test,test_function,{text})"
        schema_id: (test)
        schema_name: test
        name: test_function
        type_sig: "{text}"
        parameters: "{\"input text\"}"
        definition: select input || ' ' || version()
        description: null
        type: func
        return_type: text
        language: sql
        returns_set: false
        parallel: unsafe
        volatility: volatile
        access_privileges: null
        security: invoker    
